### 类内散度和类间散度的计算公式

在线性判别分析（LDA）中，类内散度矩阵（Within-class scatter matrix）和类间散度矩阵（Between-class scatter matrix）是核心概念。以下是它们的详细计算公式：

#### 1. 类内散度矩阵 \( S_W \)

类内散度矩阵衡量**同一类别内**样本的分散程度，计算公式为：

\[
S_W = \sum_{i=1}^{c} \sum_{x \in D_i} (x - \mu_i)(x - \mu_i)^T
\]
\[
S_B = \sum_{i=1}^{c} n_i (\mu_i - \mu)(\mu_i - \mu)^T
\]

其中：
- \( c \) 是类别总数
- \( S_i \) 是第 \( i \) 类的散度矩阵，计算公式为：

\[
S_i = \sum_{x \in D_i} (x - \mu_i)(x - \mu_i)^T
\]

这里：
- \( D_i \) 是属于第 \( i \) 类的样本集合
- \( \mu_i \) 是第 \( i \) 类样本的均值向量，计算公式为：

\[
\mu_i = \frac{1}{n_i} \sum_{x \in D_i} x
\]

- \( n_i \) 是第 \( i \) 类的样本数量

**物理意义**：\( S_W \) 越小，表示同一类别内的样本越紧凑，分类效果越好。

#### 2. 类间散度矩阵 \( S_B \)

类间散度矩阵衡量**不同类别之间**的分离程度，计算公式为：

\[
S_B = \sum_{i=1}^{c} n_i (\mu_i - \mu)(\mu_i - \mu)^T
\]

其中：
- \( \mu \) 是所有样本的总体均值向量，计算公式为：

\[
\mu = \frac{1}{n} \sum_{i=1}^{n} x_i = \frac{1}{n} \sum_{i=1}^{c} n_i \mu_i
\]

- \( n \) 是总样本数（\( n = \sum_{i=1}^{c} n_i \)）

**物理意义**：\( S_B \) 越大，表示不同类别的中心点相距越远，分类效果越好。

#### 3. 总体散度矩阵 \( S_T \)

还有一个相关的概念是总体散度矩阵，它衡量所有样本的总体分散程度：

\[
S_T = \sum_{i=1}^{n} (x_i - \mu)(x_i - \mu)^T
\]

这三个矩阵之间存在重要关系：

\[
S_T = S_W + S_B
\]

#### 应用示例

在LDA中，我们希望找到投影方向 \( w \) 使得类间散度与类内散度的比值最大化：

\[
J(w) = \frac{w^T S_B w}{w^T S_W w}
\]

通过求解广义特征值问题 \( S_B w = \lambda S_W w \)，我们可以找到最优的投影方向。

**总结**：
- \( S_W \)：衡量类别内部的紧凑程度（越小越好）
- \( S_B \)：衡量类别之间的分离程度（越大越好）
- LDA目标是最大化 \( S_B \) 与 \( S_W \) 的比值